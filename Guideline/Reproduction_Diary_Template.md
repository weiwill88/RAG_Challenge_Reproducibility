# RAG 优胜方案复现日记 (模板)

本文档旨在记录对 RAG 优胜方案进行端到端复现的全过程。我们将严格遵循操作步骤，并在每个关键节点暂停，观察和验证中间产物，将其与 `Customization_Analysis.md` 中总结的工程实践进行一一对应。

---

## 零、实验准备 (Setup)

**目标**: 配置一个纯净、可重复的实验环境。

**操作步骤**:
1.  根据 `Operational_Diary.md` 完成 Python 虚拟环境配置、PyTorch 安装和 `requirements.txt` 依赖安装。
2.  在项目根目录下创建 `.env` 文件并填入必要的 API 密钥。
3.  **关键前置操作**: 为保证复现的纯粹性，手动检查并删除 `data/test_set/` 目录下任何可能存在的 `databases` 和 `debug_data` 两个子文件夹。

**预期状态**:
-   [ ] 环境配置完毕。
-   [ ] API 密钥就绪。
-   [ ] `data/test_set/` 目录下无 `databases` 和 `debug_data` 文件夹。

---

## 一、PDF 解析 (Parsing)

**目标**: 生成结构化的 JSON 数据，并验证其质量。

**执行命令**:
```bash
# 确保当前位于 data/test_set 目录下
cd data/test_set

# 执行解析命令
python ../../main.py parse-pdfs
```

**产物观察与验证**:
-   **路径**: `data/test_set/debug_data/parsed_reports/`
-   **文件**: 检查是否为每个 PDF 都生成了对应的 `.json` 文件。

### 验证点 1.1：表格到 Markdown 的转换 (对应实践 1.2)
-   **操作**: 随机挑选一个生成的 `.json` 文件，搜索 `tables` 字段。
-   **观察与记录**:
    > 在此贴上您观察到的、被转换为 Markdown 格式的表格截图。
    >
    > (示例: ![在此处插入您的截图](...))
    >
    > **我的分析**:
    >
    > (在此记录您的分析，例如：可以看到，原始PDF中复杂的表格结构被成功转换为了LLM易于理解的 `pipe` 分隔的 Markdown 格式，这为后续的精确信息提取打下了坚实的基础。)

### 验证点 1.2：页面标准化 (对应实践 1.3)
-   **操作**: 查看任一 `.json` 文件中的 `content` 列表。
-   **观察与记录**:
    > **我的分析**:
    >
    > (在此记录您的分析，例如：经检查，`content` 列表中的每个对象的 `"page"` 字段从 1 开始，严格连续递增，中间没有出现跳跃。这证实了 `_normalize_page_sequence` 方法成功运行，解决了原始PDF可能存在的缺页问题，保证了数据的完整性和逻辑的连续性。)

---

## 二、数据注入 (Ingestion)

**目标**: 创建向量数据库，并验证“一文一库”的架构设计。

**执行命令**:
```bash
# 确保当前位于 data/test_set 目录下
python ../../main.py process-reports --config no_ser_tab
```

**产物观察与验证**:
-   **路径**: `data/test_set/databases/`
-   **文件**: 检查该目录下的文件结构。

### 验证点 2.1：“一文一库”物理隔离架构 (对应实践 2.1)
-   **操作**: 查看 `databases/` 目录的结构。
-   **观察与记录**:
    > 在此贴上您观察到的 `databases` 目录树状结构截图。
    >
    > (示例: ![在此处插入您的截图](...))
    >
    > **我的分析**:
    >
    > (在此记录您的分析，例如：截图清晰地显示，系统为 `test_set` 中的每一份PDF报告都创建了一个独立的文件夹，其名称与PDF的 `sha1` 值对应。每个文件夹内都包含独立的 `faiss.index` 和 `bm25.index` 文件。这直观地证实了“一文一库”的物理隔离设计，为后续的精准路由和检索提供了保障。)

---

## 三、问答生成 (Generation)

**目标**: 生成最终答案，并验证路由系统与结构化输出的鲁棒性。

**执行命令**:
```bash
# 确保当前位于 data/test_set 目录下
python ../../main.py process-questions --config max_nst_o3m
```

**产物观察与验证**:
-   **路径**: `data/test_set/debug_data/answers_YYYY-MM-DD_HH-MM-SS/`
-   **文件**: 找到最新生成的 `answers_1st_place_o3-mini.json` 文件。

### 验证点 3.1：高鲁棒性的结构化输出 (对应实践 4.3)
-   **操作**: 随机挑选最终答案文件中的一个问答对。
-   **观察与记录**:
    > 在此并排贴出原始问题 (来自 `questions.json`) 和最终生成的答案对象的截图。
    >
    > **原始问题截图**:
    >
    > (示例: ![在此处插入您的截图](...))
    >
    > **生成答案截图**:
    >
    > (示例: ![在此处插入您的截图](...))
    >
    > **我的分析**:
    >
    > (在此记录您的分析，并可高亮 `step_by_step_analysis` 字段。例如：可以看到，最终的答案是一个结构严谨的JSON对象。其中 `step_by_step_analysis` 字段清晰地展示了模型的思考过程（CoT），而 `final_answer` 字段则给出了完全符合要求的简洁答案。整个文件没有出现任何格式错误，这强有力地证明了 CoT + SO + Reparser 组合策略在保证输出质量和鲁棒性上的卓越效果。)

---

## 四、复现总结

> 在此写下您对整个复现过程的总体感受、遇到的问题、学到的关键知识点，以及对这些工程实践的评价。 